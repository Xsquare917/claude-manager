# 更新日志

## v1.2.2 (2025-01-30)

### 新功能

- **设置页面添加检测更新按钮**
  - 在"关于"区域的版本号左侧添加"检测更新"按钮
  - 点击后显示检测结果：发现新版本/已是最新/检测失败
  - 发现新版本时提供下载链接

### 修复

- **修复光标位置与输入不同步问题**
  - 切换会话时多次 resize 同步光标位置（50ms、150ms、300ms）
  - 确保 xterm 光标与 PTY 实际光标位置一致

- **修复侧边栏按钮点击导致终端失焦问题**
  - 所有侧边栏按钮添加 `onMouseDown` 阻止默认焦点转移
  - 包括：设置、添加项目、删除项目、删除会话、批量刷新概括

- **修复批量刷新概括功能**
  - 修复空会话时未调用 `resolve()` 导致队列卡住的问题
  - 修复错误处理时未更新 sessionManager 状态的问题
  - 按钮禁用时间改为动态计算（根据会话数量）

- **修复浅色主题下未读红点不显示问题**
  - 为浅色主题添加更深的红点颜色和阴影效果

- **修复浅色主题下代码块文字不可见问题**
  - 将 ANSI white/brightWhite 颜色改为深灰色
  - 确保代码块内容在白色背景下清晰可见

- **修复会话历史记录显示不完整问题**
  - 将历史缓冲区从 1000 增加到 5000 个数据块
  - 支持存储更长的会话历史

### 优化

- **浅色主题光标颜色优化**
  - 光标改为淡紫色，更柔和美观

- **浅色主题终端黑色文字优化**
  - 黑色改为中灰色，避免对比度过高

- **忙碌状态颜色优化**
  - 从黄色改为橙色，更符合"活跃/进行中"的语义

---

## v1.2.1 (2025-01-30)

### 修复

- **修复退出时会话未清理问题**
  - 应用退出时自动 kill 所有 Claude 会话进程
  - 避免关闭应用后留下孤儿进程

- **修复光标位置错乱问题**
  - 切换会话时光标可能不在输入行的问题
  - 历史加载后自动滚动到底部
  - 重新同步终端尺寸，确保 CLI 正确绘制输入行

- **修复常用指令模板不生效问题**
  - 设置页添加的指令模板现在能正确填入新会话
  - 等待终端初始化完成后再填入模板内容

- **修复浅色主题终端内容不可见问题**
  - 配置完整的 ANSI 16 色调色板
  - 将白色系文字改为深色，确保在浅色背景下可见
  - 优化黄色系颜色，避免太浅看不清

- **优化摘要生成功能**
  - 增加 API 请求间隔（500ms → 1500ms），减少限流
  - 添加自动重试机制（最多 2 次）
  - 清理终端控制字符，提高摘要质量
  - 更详细的错误提示（区分限流、认证、解析错误）

### 改进

- **简化添加项目流程**
  - 点击添加项目直接打开目录选择器
  - 移除中间的模态框步骤

- **优化终端初始化**
  - PTY 默认尺寸调整为标准 80x24
  - 减少初始尺寸与实际尺寸的差异

---

## v1.2.0

- 初始发布版本
- 多项目管理
- 多会话支持
- AI 状态摘要
- 主题切换
- 自动更新检查
